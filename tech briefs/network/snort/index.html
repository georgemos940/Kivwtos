<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Personal vault for notes, snippets, and ideas."><meta name=author content="George M."><link href=https://georgemos940.github.io/Kivwtos/tech%20briefs/network/snort/ rel=canonical><link href=../../CTI/yara-rules/ rel=prev><link href=../networkminer/ rel=next><link rel=icon href=../../../assets/favicon.jpg><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.6.18"><title>Snort - Open Source Intrusion Prevention System (IPS) - Kivwtos</title><link rel=stylesheet href=../../../assets/stylesheets/main.7e37652d.min.css><link rel=stylesheet href=../../../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../../assets/css/extra.css><script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=slate data-md-color-primary=indigo data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#snort-an-overview-and-historical-background class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--shadow" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../../.. title=Kivwtos class="md-header__button md-logo" aria-label=Kivwtos data-md-component=logo> <img src=../../../assets/logo.png alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Kivwtos </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Snort - Open Source Intrusion Prevention System (IPS) </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=slate data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> <input class=md-option data-md-color-media data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18V6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-2.69L23.31 12 20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20z"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/georgemos940/Kivwtos title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill=currentColor d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </div> <div class=md-source__repository> georgemos940/Kivwtos </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--integrated" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../.. title=Kivwtos class="md-nav__button md-logo" aria-label=Kivwtos data-md-component=logo> <img src=../../../assets/logo.png alt=logo> </a> Kivwtos </label> <div class=md-nav__source> <a href=https://github.com/georgemos940/Kivwtos title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill=currentColor d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </div> <div class=md-source__repository> georgemos940/Kivwtos </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../.. class=md-nav__link> <span class=md-ellipsis> Homepage </span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2 checked> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex=0> <span class=md-ellipsis> 📚 Tech Briefs </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=true> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> 📚 Tech Briefs </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_1> <label class=md-nav__link for=__nav_2_1 id=__nav_2_1_label tabindex=0> <span class=md-ellipsis> Cryptography </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_1_label aria-expanded=false> <label class=md-nav__title for=__nav_2_1> <span class="md-nav__icon md-icon"></span> Cryptography </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../cryptography/diff-hash-encod-encry/ class=md-nav__link> <span class=md-ellipsis> Differences between Hashing Encoding and Encryption </span> </a> </li> <li class=md-nav__item> <a href=../../cryptography/p-np/ class=md-nav__link> <span class=md-ellipsis> The P=NP Problem </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_2> <label class=md-nav__link for=__nav_2_2 id=__nav_2_2_label tabindex=0> <span class=md-ellipsis> Website </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2_2> <span class="md-nav__icon md-icon"></span> Website </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../website/sec_headers/ class=md-nav__link> <span class=md-ellipsis> HTTP Security Headers </span> </a> </li> <li class=md-nav__item> <a href=../../website/javascript-var-let-const/ class=md-nav__link> <span class=md-ellipsis> Javascript Differences var/let/const </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_3> <label class=md-nav__link for=__nav_2_3 id=__nav_2_3_label tabindex=0> <span class=md-ellipsis> CTI </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_3_label aria-expanded=false> <label class=md-nav__title for=__nav_2_3> <span class="md-nav__icon md-icon"></span> CTI </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../CTI/yara-rules/ class=md-nav__link> <span class=md-ellipsis> What is YARA & What Does It Detect? </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_4 checked> <label class=md-nav__link for=__nav_2_4 id=__nav_2_4_label tabindex=0> <span class=md-ellipsis> Network </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_4_label aria-expanded=true> <label class=md-nav__title for=__nav_2_4> <span class="md-nav__icon md-icon"></span> Network </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Snort - Open Source Intrusion Prevention System (IPS) </span> </a> </li> <li class=md-nav__item> <a href=../networkminer/ class=md-nav__link> <span class=md-ellipsis> NetworkMiner - an open-source traffic sniffer, PCAP handler and protocol analyser. </span> </a> </li> <li class=md-nav__item> <a href=../zeek/ class=md-nav__link> <span class=md-ellipsis> Zeek - is a passive traffic analysis framework </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex=0> <span class=md-ellipsis> 🖥️ SOC </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> 🖥️ SOC </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../soc/links/ class=md-nav__link> <span class=md-ellipsis> Links </span> </a> </li> <li class=md-nav__item> <a href=../../../soc/templates/ class=md-nav__link> <span class=md-ellipsis> Templates </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex=0> <span class=md-ellipsis> 💩 Windows </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> 💩 Windows </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../windows/windows-activation/ class=md-nav__link> <span class=md-ellipsis> Activate Windows/Office </span> </a> </li> <li class=md-nav__item> <a href=../../../windows/free-spotify/ class=md-nav__link> <span class=md-ellipsis> Free Spotify </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5> <label class=md-nav__link for=__nav_5 id=__nav_5_label tabindex=0> <span class=md-ellipsis> 🎮 Games </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> 🎮 Games </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../games/cracked-games/ class=md-nav__link> <span class=md-ellipsis> Cracked Games </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6> <label class=md-nav__link for=__nav_6 id=__nav_6_label tabindex=0> <span class=md-ellipsis> 🔍 Sites for Oscar </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_6_label aria-expanded=false> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> 🔍 Sites for Oscar </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../sites%20for%20oscar/fhmy/ class=md-nav__link> <span class=md-ellipsis> FHMY - Everything you need </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../aboutme/ class=md-nav__link> <span class=md-ellipsis> 👤 AboutMe </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <a href="https://github.com/georgemos940/Kivwtos/edit/master/docs/tech briefs/network/snort.md" title="Edit this page" class="md-content__button md-icon" rel=edit> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg> </a> <a href="https://github.com/georgemos940/Kivwtos/raw/master/docs/tech briefs/network/snort.md" title="View source of this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"/></svg> </a> <h1 id=snort-an-overview-and-historical-background>Snort: An Overview and Historical Background<a class=headerlink href=#snort-an-overview-and-historical-background title="Permanent link">&para;</a></h1> <p><strong>Snort</strong> is a widely used open-source solution for network security that can function as both a <strong>Network Intrusion Detection System (NIDS)</strong> and a <strong>Network Intrusion Prevention System (NIPS)</strong>. It is primarily <strong>rule-based</strong>, using signatures and policy rules to identify malicious or suspicious patterns in network traffic.</p> <blockquote> <p><strong>Official description:</strong> “Snort is the foremost open-source Intrusion Prevention System (IPS) in the world. Snort IPS uses a series of rules that help define malicious network activity and uses those rules to identify matching packets and generate alerts for users.”</p> </blockquote> <p><img alt="Hashing Example" src=../../../assets/img18.png></p> <hr> <h1 id=historical-background>Historical Background<a class=headerlink href=#historical-background title="Permanent link">&para;</a></h1> <ul> <li><strong>1998 - Initial release.</strong> Snort was created by <strong>Martin Roesch</strong> as a lightweight packet sniffer and intrusion detection tool. Its speed and simplicity quickly attracted users in both academia and industry. </li> <li><strong>2001–2005 - Rapid growth.</strong> A rich, community-driven <strong>rule language</strong> and ecosystem of shared signatures turned Snort into one of the first widely adopted open-source IDS platforms. </li> <li><strong>2013 - Cisco acquisition of Sourcefire.</strong> Roesch’s company <strong>Sourcefire</strong> (the commercial steward of Snort) was acquired by <strong>Cisco</strong>. Ongoing development and threat-intelligence curation are now led by <strong>Cisco Talos</strong> in collaboration with the open-source community. </li> <li><strong>2019+ - Snort 3.</strong> A major architectural update introduced a more <strong>modular, performance-oriented</strong> engine with improved rule parsing, scalability, and extensibility.</li> </ul> <hr> <h1 id=how-snort-works-high-level>How Snort Works (High Level)<a class=headerlink href=#how-snort-works-high-level title="Permanent link">&para;</a></h1> <ol> <li><strong>Packet capture:</strong> Snort inspects network traffic in real time (libpcap or equivalent). </li> <li><strong>Preprocessors:</strong> Optional modules normalize and prepare traffic (e.g., defragmentation, stream reassembly, protocol decoding). </li> <li><strong>Detection engine:</strong> Packets/streams are matched against <strong>rules</strong> that describe threats using signatures, protocol/flow context, and payload conditions. </li> <li><strong>Actions &amp; logging:</strong> Depending on mode and rule actions, Snort can <strong>alert</strong>, <strong>log</strong>, or <strong>drop/block</strong> traffic (inline IPS).</li> </ol> <hr> <h1 id=key-capabilities>Key Capabilities<a class=headerlink href=#key-capabilities title="Permanent link">&para;</a></h1> <ul> <li><strong>Signature-based detection:</strong> Match known attack patterns (exploits, malware C2, scans). </li> <li><strong>Protocol analysis &amp; normalization:</strong> Catch evasions and malformed traffic. </li> <li><strong>Content and PCRE matching:</strong> Deep payload inspection with flexible conditions. </li> <li><strong>Multiple deployment modes:</strong> </li> <li><strong>NIDS (passive):</strong> Monitor and alert. </li> <li><strong>NIPS (inline):</strong> Prevent by dropping packets. </li> <li><strong>Integration-friendly output:</strong> Unified2/JSON logs; works with SIEMs, dashboards, and SOC tooling. </li> <li><strong>Rich rule ecosystem:</strong> Community and Talos rulesets, with continuous updates.</li> </ul> <hr> <h1 id=common-use-cases>Common Use Cases<a class=headerlink href=#common-use-cases title="Permanent link">&para;</a></h1> <ul> <li><strong>Intrusion detection &amp; prevention</strong> for enterprise and service-provider networks. </li> <li><strong>Threat hunting &amp; forensics</strong> via detailed logs and packet captures. </li> <li><strong>Compliance &amp; monitoring</strong> (e.g., detecting policy violations or suspicious lateral movement). </li> <li><strong>Lab/training</strong> environments to study network attacks and defenses.</li> </ul> <hr> <h1 id=ids-vs-ips-overview-before-snort>IDS vs IPS Overview (Before Snort)<a class=headerlink href=#ids-vs-ips-overview-before-snort title="Permanent link">&para;</a></h1> <p>Before diving into <strong>Snort</strong> and traffic analysis, it's essential to understand what an <strong>Intrusion Detection System (IDS)</strong> and an <strong>Intrusion Prevention System (IPS)</strong> are. Both can be configured within a network infrastructure, but they serve different purposes.</p> <hr> <h1 id=intrusion-detection-system-ids>Intrusion Detection System (IDS)<a class=headerlink href=#intrusion-detection-system-ids title="Permanent link">&para;</a></h1> <p>IDS is a <strong>passive monitoring solution</strong> designed to <strong>detect malicious activities, abnormal behavior, or policy violations</strong>. It <strong>generates alerts</strong> when suspicious events are detected, but it <strong>does not block or stop traffic</strong>.</p> <h3 id=types-of-ids>Types of IDS:<a class=headerlink href=#types-of-ids title="Permanent link">&para;</a></h3> <ul> <li> <p><strong>Network Intrusion Detection System (NIDS):</strong><br> Monitors traffic across an entire <strong>subnet</strong>. If a signature matches a known threat, an <strong>alert</strong> is triggered.</p> </li> <li> <p><strong>Host-based Intrusion Detection System (HIDS):</strong><br> Monitors traffic and events on a <strong>single host or device</strong>. Detects local suspicious activity and generates alerts.</p> </li> </ul> <hr> <h1 id=intrusion-prevention-system-ips>Intrusion Prevention System (IPS)<a class=headerlink href=#intrusion-prevention-system-ips title="Permanent link">&para;</a></h1> <p>IPS is an <strong>active protection solution</strong> that not only detects but also <strong>prevents malicious activities</strong>. It can <strong>stop, block, or terminate</strong> the suspicious connection immediately upon detection.</p> <h1 id=types-of-ips>Types of IPS:<a class=headerlink href=#types-of-ips title="Permanent link">&para;</a></h1> <ul> <li> <p><strong>Network Intrusion Prevention System (NIPS):</strong><br> Monitors and protects the entire <strong>subnet</strong> by blocking malicious traffic.</p> </li> <li> <p><strong>Behavior-based IPS (Network Behavior Analysis - NBA):</strong><br> Detects anomalies by learning what is considered <strong>“normal” traffic</strong> (baselining) and identifying deviations. </p> <blockquote> <p><em>Note: Training is crucial to reduce false positives. A poorly trained system may produce incorrect results or miss attacks.</em></p> </blockquote> </li> <li> <p><strong>Wireless Intrusion Prevention System (WIPS):</strong><br> Focused on securing <strong>wireless networks</strong> by detecting and blocking wireless-based attacks.</p> </li> <li> <p><strong>Host-based Intrusion Prevention System (HIPS):</strong><br> Protects a <strong>single endpoint</strong>, actively terminating malicious connections. </p> <blockquote> <p><em>HIPS works like HIDS but adds prevention capabilities instead of only generating alerts.</em></p> </blockquote> </li> </ul> <hr> <h1 id=detection-prevention-techniques>Detection &amp; Prevention Techniques<a class=headerlink href=#detection-prevention-techniques title="Permanent link">&para;</a></h1> <p>IDS and IPS solutions typically use <strong>three main approaches</strong>:</p> <table> <thead> <tr> <th>Technique</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><strong>Signature-Based</strong></td> <td>Matches known attack patterns. Effective for known threats.</td> </tr> <tr> <td><strong>Behavior-Based</strong></td> <td>Detects anomalies compared to normal traffic. Useful for unknown threats.</td> </tr> <tr> <td><strong>Policy-Based</strong></td> <td>Compares activities against predefined policies to detect violations.</td> </tr> </tbody> </table> <hr> <h1 id=summary-ids-vs-ips>Summary (IDS vs IPS)<a class=headerlink href=#summary-ids-vs-ips title="Permanent link">&para;</a></h1> <ul> <li><strong>IDS</strong> → Detects threats, but <strong>requires user action</strong> to block them. </li> <li><strong>IPS</strong> → Detects <strong>and automatically blocks</strong> threats in real time. </li> </ul> <hr> <h1 id=snort-overview>Snort: Overview<a class=headerlink href=#snort-overview title="Permanent link">&para;</a></h1> <p><strong>Snort</strong> is an <strong>open-source, rule-based Network Intrusion Detection and Prevention System (NIDS/NIPS)</strong> developed by <strong>Martin Roesch</strong> in 1998. It is maintained by the <strong>open-source community</strong> and the <strong>Cisco Talos team</strong>.</p> <blockquote> <p><em>Official Description:</em><br> “Snort can be deployed inline to stop these packets, as well. Snort has three primary uses:<br> - As a packet sniffer like tcpdump<br> - As a packet logger (for network debugging)<br> - As a full-blown Network Intrusion Prevention System.” </p> </blockquote> <hr> <h1 id=key-capabilities-of-snort>Key Capabilities of Snort<a class=headerlink href=#key-capabilities-of-snort title="Permanent link">&para;</a></h1> <ul> <li><strong>Live traffic analysis</strong></li> <li><strong>Attack and probe detection</strong></li> <li><strong>Packet logging</strong></li> <li><strong>Protocol analysis</strong></li> <li><strong>Real-time alerting</strong></li> <li><strong>Support for modules &amp; plugins</strong></li> <li><strong>Pre-processors</strong></li> <li><strong>Cross-platform (Linux &amp; Windows)</strong></li> </ul> <hr> <h1 id=snort-operating-modes>Snort Operating Modes<a class=headerlink href=#snort-operating-modes title="Permanent link">&para;</a></h1> <ol> <li> <p><strong>Sniffer Mode:</strong><br> Reads and displays IP packets in real-time on the console.</p> </li> <li> <p><strong>Packet Logger Mode:</strong><br> Logs all inbound and outbound IP packets for analysis.</p> </li> <li> <p><strong>NIDS/NIPS Mode:</strong><br> Detects and blocks packets classified as malicious based on user-defined rules.</p> </li> </ol> <hr> <h1 id=snort-first-interaction-and-modes>Snort: First Interaction and Modes<a class=headerlink href=#snort-first-interaction-and-modes title="Permanent link">&para;</a></h1> <p>This guide explains how to verify Snort installation, test configurations, and run Snort in different modes: <strong>Sniffer</strong>, <strong>Logger</strong>, <strong>IDS/IPS</strong>, and <strong>PCAP</strong>. Everything is inside a single code block for easy copy-paste.</p> <hr> <h1 id=0-verify-installation-config-test>0) Verify Installation &amp; Config Test<a class=headerlink href=#0-verify-installation-config-test title="Permanent link">&para;</a></h1> <h1 id=show-snort-version>Show Snort version<a class=headerlink href=#show-snort-version title="Permanent link">&para;</a></h1> <div class=highlight><pre><span></span><code><span class=n>snort</span> <span class=o>-</span><span class=n>V</span>
</code></pre></div> <h1 id=test-the-configuration-file>Test the configuration file<a class=headerlink href=#test-the-configuration-file title="Permanent link">&para;</a></h1> <div class=highlight><pre><span></span><code><span class=n>sudo</span> <span class=n>snort</span> <span class=o>-</span><span class=n>T</span> <span class=o>-</span><span class=n>c</span> <span class=o>/</span><span class=n>etc</span><span class=o>/</span><span class=n>snort</span><span class=o>/</span><span class=n>snort</span><span class=o>.</span><span class=n>conf</span>
</code></pre></div> <h1 id=quiet-mode-hide-banner>Quiet mode (hide banner)<a class=headerlink href=#quiet-mode-hide-banner title="Permanent link">&para;</a></h1> <div class=highlight><pre><span></span><code><span class=n>snort</span> <span class=o>-</span><span class=n>q</span>
</code></pre></div> <h1 id=core-parameters>Core Parameters<a class=headerlink href=#core-parameters title="Permanent link">&para;</a></h1> <table> <thead> <tr> <th>Parameter</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td>-V</td> <td>Show Snort version</td> </tr> <tr> <td>-c</td> <td>Use configuration file</td> </tr> <tr> <td>-T</td> <td>Test configuration and exit</td> </tr> <tr> <td>-q</td> <td>Quiet mode: hide banner &amp; info</td> </tr> </tbody> </table> <hr> <h1 id=1-sniffer-mode-like-tcpdump>1) Sniffer Mode (like tcpdump)<a class=headerlink href=#1-sniffer-mode-like-tcpdump title="Permanent link">&para;</a></h1> <p>Snort can display packet info on the fly.</p> <h3 id=parameters>Parameters<a class=headerlink href=#parameters title="Permanent link">&para;</a></h3> <table> <thead> <tr> <th>Parameter</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td>-v</td> <td>Verbose: TCP/IP headers</td> </tr> <tr> <td>-d</td> <td>Show packet data (payload)</td> </tr> <tr> <td>-e</td> <td>Show link-layer headers</td> </tr> <tr> <td>-X</td> <td>Full packet in HEX + ASCII</td> </tr> <tr> <td>-i <if></td> <td>Interface to listen on (e.g., eth0)</td> </tr> </tbody> </table> <h1 id=examples>Examples<a class=headerlink href=#examples title="Permanent link">&para;</a></h1> <h1 id=verbose-on-eth0>Verbose on eth0<a class=headerlink href=#verbose-on-eth0 title="Permanent link">&para;</a></h1> <div class=highlight><pre><span></span><code><span class=n>sudo</span> <span class=n>snort</span> <span class=o>-</span><span class=n>v</span> <span class=o>-</span><span class=n>i</span> <span class=n>eth0</span>
</code></pre></div> <h1 id=verbose-payload>Verbose + payload<a class=headerlink href=#verbose-payload title="Permanent link">&para;</a></h1> <div class=highlight><pre><span></span><code><span class=n>sudo</span> <span class=n>snort</span> <span class=o>-</span><span class=n>vd</span>
</code></pre></div> <h1 id=verbose-payload-link-layer>Verbose + payload + link-layer<a class=headerlink href=#verbose-payload-link-layer title="Permanent link">&para;</a></h1> <div class=highlight><pre><span></span><code><span class=n>sudo</span> <span class=n>snort</span> <span class=o>-</span><span class=n>vde</span>
</code></pre></div> <h1 id=full-packet-dump>Full packet dump<a class=headerlink href=#full-packet-dump title="Permanent link">&para;</a></h1> <div class=highlight><pre><span></span><code><span class=n>sudo</span> <span class=n>snort</span> <span class=o>-</span><span class=n>X</span>
</code></pre></div> <hr> <h1 id=2-logger-mode-save-traffic>2) Logger Mode (save traffic)<a class=headerlink href=#2-logger-mode-save-traffic title="Permanent link">&para;</a></h1> <p>Snort can log packets for later analysis.</p> <h1 id=parameters_1>Parameters<a class=headerlink href=#parameters_1 title="Permanent link">&para;</a></h1> <table> <thead> <tr> <th>Parameter</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td>-l DIR</td> <td>Log directory (default: /var/log/snort)</td> </tr> <tr> <td>-K ASCII</td> <td>Log packets in ASCII format</td> </tr> <tr> <td>-r FILE</td> <td>Read binary log file</td> </tr> <tr> <td>-n NUM</td> <td>Limit number of packets processed</td> </tr> </tbody> </table> <h1 id=examples_1>Examples<a class=headerlink href=#examples_1 title="Permanent link">&para;</a></h1> <h1 id=log-in-current-directory>Log in current directory<a class=headerlink href=#log-in-current-directory title="Permanent link">&para;</a></h1> <div class=highlight><pre><span></span><code><span class=n>sudo</span> <span class=n>snort</span> <span class=o>-</span><span class=n>dev</span> <span class=o>-</span><span class=n>l</span> <span class=o>.</span>
</code></pre></div> <h1 id=log-in-ascii-format>Log in ASCII format<a class=headerlink href=#log-in-ascii-format title="Permanent link">&para;</a></h1> <div class=highlight><pre><span></span><code><span class=n>sudo</span> <span class=n>snort</span> <span class=o>-</span><span class=n>dev</span> <span class=o>-</span><span class=n>K</span> <span class=n>ASCII</span> <span class=o>-</span><span class=n>l</span> <span class=o>.</span>
</code></pre></div> <h1 id=read-a-log-file>Read a log file<a class=headerlink href=#read-a-log-file title="Permanent link">&para;</a></h1> <div class=highlight><pre><span></span><code><span class=n>sudo</span> <span class=n>snort</span> <span class=o>-</span><span class=n>r</span> <span class=n>snort</span><span class=o>.</span><span class=n>log</span> <span class=o>-</span><span class=n>X</span>
</code></pre></div> <h1 id=read-log-with-bpf-filter>Read log with BPF filter<a class=headerlink href=#read-log-with-bpf-filter title="Permanent link">&para;</a></h1> <div class=highlight><pre><span></span><code><span class=n>sudo</span> <span class=n>snort</span> <span class=o>-</span><span class=n>r</span> <span class=n>snort</span><span class=o>.</span><span class=n>log</span> <span class=n>icmp</span>
<span class=n>sudo</span> <span class=n>snort</span> <span class=o>-</span><span class=n>r</span> <span class=n>snort</span><span class=o>.</span><span class=n>log</span> <span class=n>tcp</span>
<span class=n>sudo</span> <span class=n>snort</span> <span class=o>-</span><span class=n>r</span> <span class=n>snort</span><span class=o>.</span><span class=n>log</span> <span class=s1>&#39;udp and port 53&#39;</span>
</code></pre></div> <h1 id=read-only-10-packets>Read only 10 packets<a class=headerlink href=#read-only-10-packets title="Permanent link">&para;</a></h1> <div class=highlight><pre><span></span><code><span class=n>sudo</span> <span class=n>snort</span> <span class=o>-</span><span class=n>dvr</span> <span class=n>snort</span><span class=o>.</span><span class=n>log</span> <span class=o>-</span><span class=n>n</span> <span class=mi>10</span>
</code></pre></div> <h1 id=ownership-note>Ownership Note<a class=headerlink href=#ownership-note title="Permanent link">&para;</a></h1> <p>Logs created as root → need sudo or change ownership: <div class=highlight><pre><span></span><code><span class=n>sudo</span> <span class=n>chown</span> <span class=err>$</span><span class=n>USER</span><span class=p>:</span><span class=err>$</span><span class=n>USER</span> <span class=n>snort</span><span class=o>.</span><span class=n>log</span>
</code></pre></div></p> <hr> <h1 id=3-idsips-mode-rule-based-detection>3) IDS/IPS Mode (rule-based detection)<a class=headerlink href=#3-idsips-mode-rule-based-detection title="Permanent link">&para;</a></h1> <p>Run Snort with rules from your config.</p> <h1 id=parameters_2>Parameters<a class=headerlink href=#parameters_2 title="Permanent link">&para;</a></h1> <table> <thead> <tr> <th>Parameter</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td>-c FILE</td> <td>Config file (required)</td> </tr> <tr> <td>-T</td> <td>Test configuration</td> </tr> <tr> <td>-N</td> <td>Disable logging</td> </tr> <tr> <td>-D</td> <td>Daemon mode</td> </tr> <tr> <td>-A MODE</td> <td>Alert mode: console, cmg, fast, full, none</td> </tr> </tbody> </table> <h1 id=alert-modes>Alert Modes<a class=headerlink href=#alert-modes title="Permanent link">&para;</a></h1> <table> <thead> <tr> <th>Mode</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td>console</td> <td>Fast-style alerts in console</td> </tr> <tr> <td>cmg</td> <td>Header + payload (hex/text) in console</td> </tr> <tr> <td>fast</td> <td>Minimal alert in log only</td> </tr> <tr> <td>full</td> <td>Detailed alert in log only</td> </tr> <tr> <td>none</td> <td>Disable alerts (still logs traffic)</td> </tr> </tbody> </table> <h1 id=examples_2>Examples<a class=headerlink href=#examples_2 title="Permanent link">&para;</a></h1> <h1 id=test-config>Test config<a class=headerlink href=#test-config title="Permanent link">&para;</a></h1> <div class=highlight><pre><span></span><code><span class=n>sudo</span> <span class=n>snort</span> <span class=o>-</span><span class=n>c</span> <span class=o>/</span><span class=n>etc</span><span class=o>/</span><span class=n>snort</span><span class=o>/</span><span class=n>snort</span><span class=o>.</span><span class=n>conf</span> <span class=o>-</span><span class=n>T</span>
</code></pre></div> <h1 id=run-with-console-alerts>Run with console alerts<a class=headerlink href=#run-with-console-alerts title="Permanent link">&para;</a></h1> <div class=highlight><pre><span></span><code><span class=n>sudo</span> <span class=n>snort</span> <span class=o>-</span><span class=n>c</span> <span class=o>/</span><span class=n>etc</span><span class=o>/</span><span class=n>snort</span><span class=o>/</span><span class=n>snort</span><span class=o>.</span><span class=n>conf</span> <span class=o>-</span><span class=n>A</span> <span class=n>console</span>
</code></pre></div> <h1 id=idsips-mode-with-parameter-a-cmg>IDS/IPS mode with parameter "-A cmg"<a class=headerlink href=#idsips-mode-with-parameter-a-cmg title="Permanent link">&para;</a></h1> <p>Cmg mode provides basic header details with payload in hex and text format. <div class=highlight><pre><span></span><code><span class=n>sudo</span> <span class=n>snort</span> <span class=o>-</span><span class=n>c</span> <span class=o>/</span><span class=n>etc</span><span class=o>/</span><span class=n>snort</span><span class=o>/</span><span class=n>snort</span><span class=o>.</span><span class=n>conf</span> <span class=o>-</span><span class=n>A</span> <span class=n>cmg</span>
</code></pre></div></p> <h1 id=idsips-mode-with-parameter-a-fast>IDS/IPS mode with parameter "-A fast"<a class=headerlink href=#idsips-mode-with-parameter-a-fast title="Permanent link">&para;</a></h1> <p>Fast mode provides alert messages, timestamps, and source and destination IP addresses. <strong>Remember, there is no console output in this mode.</strong> <div class=highlight><pre><span></span><code><span class=n>sudo</span> <span class=n>snort</span> <span class=o>-</span><span class=n>c</span> <span class=o>/</span><span class=n>etc</span><span class=o>/</span><span class=n>snort</span><span class=o>/</span><span class=n>snort</span><span class=o>.</span><span class=n>conf</span> <span class=o>-</span><span class=n>A</span> <span class=n>fast</span>
</code></pre></div></p> <h1 id=idsips-mode-with-parameter-a-full>IDS/IPS mode with parameter "-A full"<a class=headerlink href=#idsips-mode-with-parameter-a-full title="Permanent link">&para;</a></h1> <p>Full alert mode provides all possible information about the alert. <strong>Remember, there is no console output in this mode.</strong> <div class=highlight><pre><span></span><code><span class=n>sudo</span> <span class=n>snort</span> <span class=o>-</span><span class=n>c</span> <span class=o>/</span><span class=n>etc</span><span class=o>/</span><span class=n>snort</span><span class=o>/</span><span class=n>snort</span><span class=o>.</span><span class=n>conf</span> <span class=o>-</span><span class=n>A</span> <span class=n>full</span>
</code></pre></div></p> <h1 id=idsips-mode-with-parameter-a-none>IDS/IPS mode with parameter "-A none"<a class=headerlink href=#idsips-mode-with-parameter-a-none title="Permanent link">&para;</a></h1> <p>Disable alerting. This mode doesn't create the alert file. However, it still logs the traffic and creates a log file in binary dump format. Remember, there is no console output in this mode. <div class=highlight><pre><span></span><code><span class=n>sudo</span> <span class=n>snort</span> <span class=o>-</span><span class=n>c</span> <span class=o>/</span><span class=n>etc</span><span class=o>/</span><span class=n>snort</span><span class=o>/</span><span class=n>snort</span><span class=o>.</span><span class=n>conf</span> <span class=o>-</span><span class=n>A</span> <span class=n>none</span>
</code></pre></div></p> <h1 id=disable-logging>Disable logging<a class=headerlink href=#disable-logging title="Permanent link">&para;</a></h1> <div class=highlight><pre><span></span><code><span class=n>sudo</span> <span class=n>snort</span> <span class=o>-</span><span class=n>c</span> <span class=o>/</span><span class=n>etc</span><span class=o>/</span><span class=n>snort</span><span class=o>/</span><span class=n>snort</span><span class=o>.</span><span class=n>conf</span> <span class=o>-</span><span class=n>N</span>
</code></pre></div> <h1 id=background-mode>Background mode<a class=headerlink href=#background-mode title="Permanent link">&para;</a></h1> <div class=highlight><pre><span></span><code><span class=n>sudo</span> <span class=n>snort</span> <span class=o>-</span><span class=n>c</span> <span class=o>/</span><span class=n>etc</span><span class=o>/</span><span class=n>snort</span><span class=o>/</span><span class=n>snort</span><span class=o>.</span><span class=n>conf</span> <span class=o>-</span><span class=n>D</span>
</code></pre></div> <h1 id=ips-mode-and-dropping-packets>IPS mode and dropping packets<a class=headerlink href=#ips-mode-and-dropping-packets title="Permanent link">&para;</a></h1> <p>Snort IPS mode activated with -Q --daq afpacket parameters. You can also activate this mode by editing snort.conf file. However, you don't need to edit snort.conf file in the scope of this room. Review the bonus task or snort manual for further information on daq and advanced configuration settings: <code>-Q --daq afpacket</code> Activate the Data Acquisition (DAQ) modules and use the afpacket module to use snort as an IPS: <code>-i eth0:eth1</code> Identifying interfaces note that Snort IPS require at least two interfaces to work. Now run the traffic-generator script as sudo and start ICMP/HTTP traffic. <div class=highlight><pre><span></span><code><span class=n>sudo</span> <span class=n>snort</span> <span class=o>-</span><span class=n>c</span> <span class=o>/</span><span class=n>etc</span><span class=o>/</span><span class=n>snort</span><span class=o>/</span><span class=n>snort</span><span class=o>.</span><span class=n>conf</span> <span class=o>-</span><span class=n>q</span> <span class=o>-</span><span class=n>Q</span> <span class=o>--</span><span class=n>daq</span> <span class=n>afpacket</span> <span class=o>-</span><span class=n>i</span> <span class=n>eth0</span><span class=p>:</span><span class=n>eth1</span> <span class=o>-</span><span class=n>A</span> <span class=n>console</span>
</code></pre></div></p> <hr> <h1 id=4-pcap-mode-offline-analysis>4) PCAP Mode (offline analysis)<a class=headerlink href=#4-pcap-mode-offline-analysis title="Permanent link">&para;</a></h1> <p>Analyze pcap files for alerts and stats.</p> <h1 id=parameters_3>Parameters<a class=headerlink href=#parameters_3 title="Permanent link">&para;</a></h1> <table> <thead> <tr> <th>Parameter</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td>-r FILE</td> <td>Read a single pcap</td> </tr> <tr> <td>--pcap-list="a b c"</td> <td>Process multiple pcaps</td> </tr> <tr> <td>--pcap-show</td> <td>Show pcap name while processing</td> </tr> </tbody> </table> <h1 id=examples_3>Examples<a class=headerlink href=#examples_3 title="Permanent link">&para;</a></h1> <h1 id=basic-read>Basic read<a class=headerlink href=#basic-read title="Permanent link">&para;</a></h1> <div class=highlight><pre><span></span><code><span class=n>python</span> <span class=n>snort</span> <span class=o>-</span><span class=n>r</span> <span class=n>sample</span><span class=o>.</span><span class=n>pcap</span>
</code></pre></div> <h1 id=read-with-config-and-alerts>Read with config and alerts<a class=headerlink href=#read-with-config-and-alerts title="Permanent link">&para;</a></h1> <div class=highlight><pre><span></span><code><span class=n>sudo</span> <span class=n>snort</span> <span class=o>-</span><span class=n>c</span> <span class=o>/</span><span class=n>etc</span><span class=o>/</span><span class=n>snort</span><span class=o>/</span><span class=n>snort</span><span class=o>.</span><span class=n>conf</span> <span class=o>-</span><span class=n>q</span> <span class=o>-</span><span class=n>r</span> <span class=n>icmp</span><span class=o>.</span><span class=n>pcap</span> <span class=o>-</span><span class=n>A</span> <span class=n>console</span> <span class=o>-</span><span class=n>n</span> <span class=mi>10</span>
</code></pre></div> <h1 id=multiple-pcaps>Multiple pcaps<a class=headerlink href=#multiple-pcaps title="Permanent link">&para;</a></h1> <div class=highlight><pre><span></span><code><span class=n>sudo</span> <span class=n>snort</span> <span class=o>-</span><span class=n>c</span> <span class=o>/</span><span class=n>etc</span><span class=o>/</span><span class=n>snort</span><span class=o>/</span><span class=n>snort</span><span class=o>.</span><span class=n>conf</span> <span class=o>--</span><span class=n>pcap</span><span class=o>-</span><span class=nb>list</span><span class=o>=</span><span class=s2>&quot;icmp.pcap http.pcap&quot;</span> <span class=o>-</span><span class=n>A</span> <span class=n>console</span>
</code></pre></div> <h1 id=show-pcap-names>Show pcap names<a class=headerlink href=#show-pcap-names title="Permanent link">&para;</a></h1> <div class=highlight><pre><span></span><code><span class=n>sudo</span> <span class=n>snort</span> <span class=o>-</span><span class=n>c</span> <span class=o>/</span><span class=n>etc</span><span class=o>/</span><span class=n>snort</span><span class=o>/</span><span class=n>snort</span><span class=o>.</span><span class=n>conf</span> <span class=o>--</span><span class=n>pcap</span><span class=o>-</span><span class=nb>list</span><span class=o>=</span><span class=s2>&quot;icmp.pcap http.pcap&quot;</span> <span class=o>-</span><span class=n>A</span> <span class=n>console</span> <span class=o>--</span><span class=n>pcap</span><span class=o>-</span><span class=n>show</span>
</code></pre></div> <hr> <h1 id=5-rule-basics>5) Rule Basics<a class=headerlink href=#5-rule-basics title="Permanent link">&para;</a></h1> <div class=highlight><pre><span></span><code><span class=n>Snort</span> <span class=n>rules</span> <span class=o>=</span> <span class=o>**</span><span class=n>action</span> <span class=o>+</span> <span class=n>protocol</span> <span class=o>+</span> <span class=n>src</span><span class=o>/</span><span class=n>dst</span> <span class=n>IP</span> <span class=o>+</span> <span class=n>ports</span> <span class=o>+</span> <span class=n>direction</span> <span class=o>+</span> <span class=n>options</span><span class=o>**.</span>
</code></pre></div> <h1 id=common-actions>Common Actions<a class=headerlink href=#common-actions title="Permanent link">&para;</a></h1> <table> <thead> <tr> <th>Action</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td>alert</td> <td>Generate alert and log packet</td> </tr> <tr> <td>log</td> <td>Log packet only</td> </tr> <tr> <td>drop</td> <td>Drop packet + log (IPS mode required)</td> </tr> <tr> <td>reject</td> <td>Drop + log + send TCP RST/ICMP unreachable</td> </tr> </tbody> </table> <h1 id=direction>Direction<a class=headerlink href=#direction title="Permanent link">&para;</a></h1> <table> <thead> <tr> <th>Symbol</th> <th>Meaning</th> </tr> </thead> <tbody> <tr> <td>-&gt;</td> <td>Source → Destination</td> </tr> <tr> <td>&lt;&gt;</td> <td>Bidirectional</td> </tr> </tbody> </table> <h1 id=examples_4>Examples<a class=headerlink href=#examples_4 title="Permanent link">&para;</a></h1> <h1 id=simple-icmp-alert>Simple ICMP alert<a class=headerlink href=#simple-icmp-alert title="Permanent link">&para;</a></h1> <div class=highlight><pre><span></span><code><span class=n>alert</span> <span class=n>icmp</span> <span class=nb>any</span> <span class=nb>any</span> <span class=o>&lt;&gt;</span> <span class=nb>any</span> <span class=nb>any</span> <span class=p>(</span><span class=n>msg</span><span class=p>:</span><span class=s2>&quot;ICMP Packet Found&quot;</span><span class=p>;</span> <span class=n>sid</span><span class=p>:</span><span class=mi>100001</span><span class=p>;</span> <span class=n>rev</span><span class=p>:</span><span class=mi>1</span><span class=p>;)</span>
</code></pre></div> <h1 id=ip-range>IP range<a class=headerlink href=#ip-range title="Permanent link">&para;</a></h1> <div class=highlight><pre><span></span><code><span class=n>alert</span> <span class=n>icmp</span> <span class=mf>192.168.1.0</span><span class=o>/</span><span class=mi>24</span> <span class=nb>any</span> <span class=o>&lt;&gt;</span> <span class=nb>any</span> <span class=nb>any</span> <span class=p>(</span><span class=n>msg</span><span class=p>:</span><span class=s2>&quot;ICMP from subnet&quot;</span><span class=p>;</span> <span class=n>sid</span><span class=p>:</span><span class=mi>100002</span><span class=p>;</span> <span class=n>rev</span><span class=p>:</span><span class=mi>1</span><span class=p>;)</span>
</code></pre></div> <h1 id=port-filter>Port filter<a class=headerlink href=#port-filter title="Permanent link">&para;</a></h1> <div class=highlight><pre><span></span><code><span class=n>alert</span> <span class=n>tcp</span> <span class=nb>any</span> <span class=nb>any</span> <span class=o>-&gt;</span> <span class=nb>any</span> <span class=mi>21</span> <span class=p>(</span><span class=n>msg</span><span class=p>:</span><span class=s2>&quot;FTP traffic&quot;</span><span class=p>;</span> <span class=n>sid</span><span class=p>:</span><span class=mi>100003</span><span class=p>;</span> <span class=n>rev</span><span class=p>:</span><span class=mi>1</span><span class=p>;)</span>
</code></pre></div> <h1 id=negation>Negation<a class=headerlink href=#negation title="Permanent link">&para;</a></h1> <div class=highlight><pre><span></span><code><span class=n>alert</span> <span class=n>tcp</span> <span class=nb>any</span> <span class=nb>any</span> <span class=o>-&gt;</span> <span class=nb>any</span> <span class=err>!</span><span class=mi>21</span> <span class=p>(</span><span class=n>msg</span><span class=p>:</span><span class=s2>&quot;Non-FTP traffic&quot;</span><span class=p>;</span> <span class=n>sid</span><span class=p>:</span><span class=mi>100004</span><span class=p>;</span> <span class=n>rev</span><span class=p>:</span><span class=mi>1</span><span class=p>;)</span>
</code></pre></div> <p><strong>TIP:</strong> Add your rules to <code>/etc/snort/rules/local.rules</code>.</p> <h1 id=examples-rules-that-i-create-for-ctf-room>Examples rules that i create for ctf room<a class=headerlink href=#examples-rules-that-i-create-for-ctf-room title="Permanent link">&para;</a></h1> <p>Write a rule to detect all TCP packets <strong>from or to</strong> port 80. <div class=highlight><pre><span></span><code><span class=n>alert</span> <span class=n>tcp</span> <span class=nb>any</span> <span class=mi>80</span> <span class=o>&lt;&gt;</span> <span class=nb>any</span> <span class=nb>any</span> <span class=p>(</span><span class=n>msg</span><span class=p>:</span><span class=err>”</span><span class=n>TCP</span> <span class=n>port</span> <span class=mi>80</span> <span class=n>found</span><span class=err>”</span><span class=p>;</span> <span class=n>sid</span><span class=p>:</span><span class=mi>100001</span><span class=p>;</span> <span class=n>rev</span><span class=p>:</span><span class=mi>1</span><span class=p>;)</span>
</code></pre></div></p> <p>Write a <strong>single</strong> rule to detect "<strong>all TCP port 21</strong>"  traffic in the given pcap. <div class=highlight><pre><span></span><code><span class=n>alert</span> <span class=n>tcp</span> <span class=nb>any</span> <span class=mi>21</span> <span class=o>&lt;&gt;</span> <span class=nb>any</span> <span class=nb>any</span> <span class=p>(</span><span class=n>msg</span><span class=p>:</span><span class=s2>&quot;src:FTP found&quot;</span><span class=p>;</span> <span class=n>sid</span><span class=p>:</span><span class=mi>100001</span><span class=p>;</span> <span class=n>rev</span><span class=p>:</span><span class=mi>1</span><span class=p>;)</span>
</code></pre></div></p> <p>What is the FTP service name? <div class=highlight><pre><span></span><code><span class=n>sudo</span> <span class=n>snort</span> <span class=o>-</span><span class=n>r</span> <span class=n>snort</span><span class=o>.</span><span class=n>log</span><span class=mf>.1671731339</span> <span class=o>-</span><span class=n>X</span> <span class=o>-</span><span class=n>n</span> <span class=mi>10</span> <span class=o>//</span> <span class=n>read</span> <span class=mi>10</span> <span class=n>packets</span> 
</code></pre></div></p> <p>Write a rule to detect failed FTP login attempts in the given pcap. <div class=highlight><pre><span></span><code><span class=n>alert</span> <span class=n>tcp</span> <span class=nb>any</span> <span class=mi>21</span> <span class=o>&lt;&gt;</span> <span class=nb>any</span> <span class=nb>any</span> <span class=p>(</span><span class=n>msg</span><span class=p>:</span><span class=s2>&quot;Detectected Failed FTP Login&quot;</span><span class=p>;</span> <span class=n>content</span><span class=p>:</span><span class=s2>&quot;530 User&quot;</span><span class=p>;</span> <span class=n>sid</span><span class=p>:</span><span class=mi>100003</span><span class=p>;</span> <span class=n>rev</span><span class=p>:</span><span class=mi>1</span><span class=p>;)</span>
</code></pre></div> <a href=https://en.wikipedia.org/wiki/List_of_FTP_server_return_codes>List of ftp responding codes here -&gt;</a> <img alt="Hashing Example" src=../../../assets/img21.png></p> <p>Write a rule to detect successful FTP logins in the given pcap. <div class=highlight><pre><span></span><code><span class=n>alert</span> <span class=n>tcp</span> <span class=nb>any</span> <span class=mi>21</span> <span class=o>&lt;&gt;</span> <span class=nb>any</span> <span class=nb>any</span> <span class=p>(</span><span class=n>msg</span><span class=p>:</span><span class=s2>&quot;Detected Successful FTP Login&quot;</span><span class=p>;</span> <span class=n>content</span><span class=p>:</span><span class=s2>&quot;230 User&quot;</span><span class=p>;</span> <span class=n>sid</span><span class=p>:</span><span class=mi>100004</span><span class=p>;</span>
</code></pre></div></p> <p>Write a rule to detect FTP login attempts with a valid username but no password entered yet. <div class=highlight><pre><span></span><code><span class=n>alert</span> <span class=n>tcp</span> <span class=nb>any</span> <span class=mi>21</span> <span class=o>&lt;&gt;</span> <span class=nb>any</span> <span class=nb>any</span> <span class=p>(</span><span class=n>msg</span><span class=p>:</span><span class=s2>&quot;FTP Failed Login-Bad or No Password&quot;</span><span class=p>;</span> <span class=n>content</span><span class=p>:</span><span class=s2>&quot;331 Password&quot;</span><span class=p>;</span> <span class=n>sid</span><span class=p>:</span><span class=mi>100005</span><span class=p>;</span> <span class=n>rev</span><span class=p>:</span><span class=mi>1</span><span class=p>;)</span>
</code></pre></div></p> <p>Write a rule to detect FTP login attempts with the "Administrator" username but no password entered yet. <div class=highlight><pre><span></span><code><span class=n>alert</span> <span class=n>tcp</span> <span class=nb>any</span> <span class=mi>21</span> <span class=o>&lt;&gt;</span> <span class=nb>any</span> <span class=nb>any</span> <span class=p>(</span><span class=n>msg</span><span class=p>:</span><span class=s2>&quot;FTP Failed Admin Login-Bad or No Password&quot;</span><span class=p>;</span> <span class=n>content</span><span class=p>:</span><span class=s2>&quot;331 Password&quot;</span><span class=p>;</span> <span class=n>fast_pattern</span><span class=p>;</span> <span class=n>content</span><span class=p>:</span><span class=s2>&quot;Administrator&quot;</span><span class=p>;</span> <span class=n>sid</span><span class=p>:</span><span class=mi>100006</span><span class=p>;</span> <span class=n>rev</span><span class=p>:</span><span class=mi>1</span><span class=p>;)</span>
</code></pre></div></p> <p>Write a rule to detect the PNG file in the given pcap. <div class=highlight><pre><span></span><code><span class=n>alert</span> <span class=n>tcp</span> <span class=nb>any</span> <span class=nb>any</span> <span class=o>&lt;&gt;</span> <span class=nb>any</span> <span class=nb>any</span> <span class=p>(</span><span class=n>msg</span><span class=p>:</span><span class=s2>&quot;PNG file Detected&quot;</span><span class=p>;</span> <span class=n>content</span><span class=p>:</span><span class=s2>&quot;|89 50 4A 47 0D 0A 1A 0A|&quot;</span><span class=p>;</span> <span class=n>sid</span><span class=p>:</span><span class=mi>100002</span><span class=p>;</span> <span class=n>rev</span><span class=p>:</span><span class=mi>1</span><span class=p>;)</span>
</code></pre></div> <em>the || is to show a number in hex format.. every file type has a hex signature in the start of it!</em></p> <p>Write a rule to detect the GIF file in the given pcap. <div class=highlight><pre><span></span><code><span class=n>alert</span> <span class=n>tcp</span> <span class=nb>any</span> <span class=nb>any</span> <span class=o>&lt;&gt;</span> <span class=nb>any</span> <span class=nb>any</span> <span class=p>(</span><span class=n>msg</span><span class=p>:</span><span class=s2>&quot;GIF File Detected&quot;</span><span class=p>;</span> <span class=n>content</span><span class=p>:</span><span class=s2>&quot;|47 49 46 38 39|&quot;</span><span class=p>;</span> <span class=n>sid</span><span class=p>:</span><span class=mi>100003</span><span class=p>;</span> <span class=n>rev</span><span class=p>:</span><span class=mi>1</span><span class=p>;)</span>
</code></pre></div> <img alt="Hashing Example" src=../../../assets/img22.png></p> <p><em>lets create IDS Rules for torrent metafiles in the traffic!</em></p> <p>Write a rule to detect the torrent metafile in the given pcap. <div class=highlight><pre><span></span><code><span class=n>alert</span> <span class=n>tcp</span> <span class=nb>any</span> <span class=nb>any</span> <span class=o>&lt;&gt;</span> <span class=nb>any</span> <span class=nb>any</span> <span class=p>(</span><span class=n>msg</span><span class=p>:</span> <span class=s2>&quot;Torrent&quot;</span><span class=p>;</span> <span class=n>content</span><span class=p>:</span><span class=s2>&quot;torrent&quot;</span><span class=p>;</span> <span class=n>sid</span><span class=p>:</span> <span class=mi>10000001</span><span class=p>;</span> <span class=n>rev</span><span class=p>:</span><span class=mi>1</span><span class=p>;)</span>
</code></pre></div></p> <p>Write a rule to detect packet payloads <strong>between 770 and 855 bytes</strong>. <div class=highlight><pre><span></span><code><span class=n>alert</span> <span class=n>tcp</span> <span class=nb>any</span> <span class=nb>any</span> <span class=o>-&gt;</span> <span class=nb>any</span> <span class=nb>any</span> <span class=p>(</span><span class=n>msg</span><span class=p>:</span><span class=s2>&quot;Tcp connections&quot;</span><span class=p>;</span> <span class=n>dsize</span><span class=p>:</span><span class=mi>770</span><span class=o>&lt;&gt;</span><span class=mi>855</span><span class=p>;</span>  <span class=n>sid</span><span class=p>:</span> <span class=mi>100001</span><span class=p>;</span> <span class=n>rev</span><span class=p>:</span><span class=mi>1</span><span class=p>;)</span>
</code></pre></div></p> <hr> <h1 id=wrong-syntax-rules>wrong syntax rules<a class=headerlink href=#wrong-syntax-rules title="Permanent link">&para;</a></h1> <ul> <li> <p>1 syntax error <div class=highlight><pre><span></span><code><span class=n>alert</span> <span class=n>tcp</span> <span class=nb>any</span> <span class=mi>3372</span> <span class=o>-&gt;</span> <span class=nb>any</span> <span class=nb>any</span><span class=p>(</span><span class=n>msg</span><span class=p>:</span> <span class=s2>&quot;Troubleshooting 1&quot;</span><span class=p>;</span> <span class=n>sid</span><span class=p>:</span><span class=mi>1000001</span><span class=p>;</span> <span class=n>rev</span><span class=p>:</span><span class=mi>1</span><span class=p>;)</span>
</code></pre></div> [Syntax] Missing required space before options block: should be "... any any (msg: ...)"</p> </li> <li> <p>1 syntax error <div class=highlight><pre><span></span><code><span class=n>alert</span> <span class=n>icmp</span> <span class=nb>any</span> <span class=o>-&gt;</span> <span class=nb>any</span> <span class=nb>any</span> <span class=p>(</span><span class=n>msg</span><span class=p>:</span> <span class=s2>&quot;Troubleshooting 2&quot;</span><span class=p>;</span> <span class=n>sid</span><span class=p>:</span><span class=mi>1000001</span><span class=p>;</span> <span class=n>rev</span><span class=p>:</span><span class=mi>1</span><span class=p>;)</span>
</code></pre></div> [Syntax] ICMP rules do not use ports; remove the trailing destination port "any".</p> </li> <li> <p>1 syntax error <div class=highlight><pre><span></span><code><span class=n>alert</span> <span class=n>icmp</span> <span class=nb>any</span> <span class=nb>any</span> <span class=o>-&gt;</span> <span class=nb>any</span> <span class=nb>any</span> <span class=p>(</span><span class=n>msg</span><span class=p>:</span> <span class=s2>&quot;ICMP Packet Found&quot;</span><span class=p>;</span> <span class=n>sid</span><span class=p>:</span><span class=mi>1000001</span><span class=p>;</span> <span class=n>rev</span><span class=p>:</span><span class=mi>1</span><span class=p>;)</span>
<span class=n>alert</span> <span class=n>tcp</span> <span class=nb>any</span> <span class=nb>any</span> <span class=o>-&gt;</span> <span class=nb>any</span> <span class=mi>80</span><span class=p>,</span><span class=mi>443</span> <span class=p>(</span><span class=n>msg</span><span class=p>:</span> <span class=s2>&quot;HTTPX Packet Found&quot;</span><span class=p>;</span> <span class=n>sid</span><span class=p>:</span><span class=mi>1000001</span><span class=p>;</span> <span class=n>rev</span><span class=p>:</span><span class=mi>1</span><span class=p>;)</span>
</code></pre></div> [Syntax] ICMP rule incorrectly includes ports ("any any"); ICMP has no ports.</p> </li> <li> <p>2 syntax errors <div class=highlight><pre><span></span><code><span class=n>alert</span> <span class=n>icmp</span> <span class=nb>any</span> <span class=nb>any</span> <span class=o>-&gt;</span> <span class=nb>any</span> <span class=nb>any</span> <span class=p>(</span><span class=n>msg</span><span class=p>:</span> <span class=s2>&quot;ICMP Packet Found&quot;</span><span class=p>;</span> <span class=n>sid</span><span class=p>:</span><span class=mi>1000001</span><span class=p>;</span> <span class=n>rev</span><span class=p>:</span><span class=mi>1</span><span class=p>;)</span>
<span class=n>alert</span> <span class=n>tcp</span> <span class=nb>any</span> <span class=mi>80</span><span class=p>,</span><span class=mi>443</span> <span class=o>-&gt;</span> <span class=nb>any</span> <span class=nb>any</span> <span class=p>(</span><span class=n>msg</span><span class=p>:</span> <span class=s2>&quot;HTTPX Packet Found&quot;</span><span class=p>:</span> <span class=n>sid</span><span class=p>:</span><span class=mi>1000001</span><span class=p>;</span> <span class=n>rev</span><span class=p>:</span><span class=mi>1</span><span class=p>;)</span>
</code></pre></div> [Syntax 1] ICMP rule includes ports; ICMP has no ports. [Syntax 2] Extra colon after msg string: use ... msg:"HTTPX Packet Found"; sid:...</p> </li> <li> <p>2 syntax errors <div class=highlight><pre><span></span><code><span class=n>alert</span> <span class=n>icmp</span> <span class=nb>any</span> <span class=nb>any</span> <span class=o>&lt;&gt;</span> <span class=nb>any</span> <span class=nb>any</span> <span class=p>(</span><span class=n>msg</span><span class=p>:</span> <span class=s2>&quot;ICMP Packet Found&quot;</span><span class=p>;</span> <span class=n>sid</span><span class=p>:</span><span class=mi>1000001</span><span class=p>;</span> <span class=n>rev</span><span class=p>:</span><span class=mi>1</span><span class=p>;)</span>
<span class=n>alert</span> <span class=n>icmp</span> <span class=nb>any</span> <span class=nb>any</span> <span class=o>&lt;-</span> <span class=nb>any</span> <span class=nb>any</span> <span class=p>(</span><span class=n>msg</span><span class=p>:</span> <span class=s2>&quot;Inbound ICMP Packet Found&quot;</span><span class=p>;</span> <span class=n>sid</span><span class=p>;</span><span class=mi>1000002</span><span class=p>;</span> <span class=n>rev</span><span class=p>:</span><span class=mi>1</span><span class=p>;)</span>
</code></pre></div> alert tcp any any -&gt; any 80,443 (msg: "HTTPX Packet Found": sid:1000003; rev:1;) [Syntax 1] Invalid direction operator "&lt;-"; valid are "-&gt;" or "&lt;&gt;". [Syntax 2] Wrong separator in option: "sid;1000002" must be "sid:1000002".</p> </li> <li> <p>logic error (case sensitive; add <code>nocase;</code>) <div class=highlight><pre><span></span><code><span class=n>alert</span> <span class=n>tcp</span> <span class=nb>any</span> <span class=nb>any</span> <span class=o>&lt;&gt;</span> <span class=nb>any</span> <span class=mi>80</span>  <span class=p>(</span><span class=n>msg</span><span class=p>:</span> <span class=s2>&quot;GET Request Found&quot;</span><span class=p>;</span> <span class=n>content</span><span class=p>:</span><span class=s2>&quot;|67 65 74|&quot;</span><span class=p>;</span> <span class=n>sid</span><span class=p>:</span> <span class=mi>100001</span><span class=p>;</span> <span class=n>rev</span><span class=p>:</span><span class=mi>1</span><span class=p>;)</span>
</code></pre></div> [Logic] Content bytes 67 65 74 = "get" (lowercase). HTTP methods are typically uppercase. Add "nocase;" (or match ASCII "GET ") to avoid missing true positives.</p> </li> <li> <p>logic error (no msg; rule runs but not useful) <div class=highlight><pre><span></span><code><span class=n>alert</span> <span class=n>tcp</span> <span class=nb>any</span> <span class=nb>any</span> <span class=o>&lt;&gt;</span> <span class=nb>any</span> <span class=mi>80</span>  <span class=p>(</span><span class=n>content</span><span class=p>:</span><span class=s2>&quot;|2E 68 74 6D 6C|&quot;</span><span class=p>;</span> <span class=n>sid</span><span class=p>:</span> <span class=mi>100001</span><span class=p>;</span> <span class=n>rev</span><span class=p>:</span><span class=mi>1</span><span class=p>;)</span>
</code></pre></div> [Logic] Missing "msg" option; alerts will have empty/unnamed message, reducing usefulness.</p> </li> </ul> <h1 id=manual-pdf-snort-from-tryhackme>Manual PDF (Snort from tryhackme)<a class=headerlink href=#manual-pdf-snort-from-tryhackme title="Permanent link">&para;</a></h1> <p><img alt="Hashing Example" src=../../../assets/img23.png> <img alt="Hashing Example" src=../../../assets/img24.png> <img alt="Hashing Example" src=../../../assets/img25.png> <img alt="Hashing Example" src=../../../assets/img26.png> <img alt="Hashing Example" src=../../../assets/img27.png> <img alt="Hashing Example" src=../../../assets/img19.png></p> <p><img alt="Hashing Example" src=../../../assets/img20.png></p> <aside class=md-source-file> <span class=md-source-file__fact> <span class=md-icon title="Last update"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date" title="September 1, 2025 23:10:06 EEST">2025-09-01</span> </span> </aside> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Back to top </button> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../../CTI/yara-rules/ class="md-footer__link md-footer__link--prev" aria-label="Previous: What is YARA & What Does It Detect?"> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </div> <div class=md-footer__title> <span class=md-footer__direction> Previous </span> <div class=md-ellipsis> What is YARA & What Does It Detect? </div> </div> </a> <a href=../networkminer/ class="md-footer__link md-footer__link--next" aria-label="Next: NetworkMiner - an open-source traffic sniffer, PCAP handler and protocol analyser. "> <div class=md-footer__title> <span class=md-footer__direction> Next </span> <div class=md-ellipsis> NetworkMiner - an open-source traffic sniffer, PCAP handler and protocol analyser. </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> </div> <div class=md-social> <a href=https://github.com/georgemos940 target=_blank rel=noopener title=GitHub class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill=currentColor d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </a> <a href=https://discord.gg/pegasusac target=_blank rel=noopener title=Discord class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 576 512"><!-- Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill=currentColor d="M492.5 69.8c-.2-.3-.4-.6-.8-.7-38.1-17.5-78.4-30-119.7-37.1-.4-.1-.8 0-1.1.1s-.6.4-.8.8c-5.5 9.9-10.5 20.2-14.9 30.6-44.6-6.8-89.9-6.8-134.4 0-4.5-10.5-9.5-20.7-15.1-30.6-.2-.3-.5-.6-.8-.8s-.7-.2-1.1-.2C162.5 39 122.2 51.5 84.1 69c-.3.1-.6.4-.8.7C7.1 183.5-13.8 294.6-3.6 404.2c0 .3.1.5.2.8s.3.4.5.6c44.4 32.9 94 58 146.8 74.2.4.1.8.1 1.1 0s.7-.4.9-.7c11.3-15.4 21.4-31.8 30-48.8.1-.2.2-.5.2-.8s0-.5-.1-.8-.2-.5-.4-.6-.4-.3-.7-.4c-15.8-6.1-31.2-13.4-45.9-21.9-.3-.2-.5-.4-.7-.6s-.3-.6-.3-.9 0-.6.2-.9.3-.5.6-.7c3.1-2.3 6.2-4.7 9.1-7.1.3-.2.6-.4.9-.4s.7 0 1 .1c96.2 43.9 200.4 43.9 295.5 0 .3-.1.7-.2 1-.2s.7.2.9.4c2.9 2.4 6 4.9 9.1 7.2.2.2.4.4.6.7s.2.6.2.9-.1.6-.3.9-.4.5-.6.6c-14.7 8.6-30 15.9-45.9 21.8-.2.1-.5.2-.7.4s-.3.4-.4.7-.1.5-.1.8.1.5.2.8c8.8 17 18.8 33.3 30 48.8.2.3.6.6.9.7s.8.1 1.1 0c52.9-16.2 102.6-41.3 147.1-74.2.2-.2.4-.4.5-.6s.2-.5.2-.8c12.3-126.8-20.5-236.9-86.9-334.5zm-302 267.7c-29 0-52.8-26.6-52.8-59.2s23.4-59.2 52.8-59.2c29.7 0 53.3 26.8 52.8 59.2 0 32.7-23.4 59.2-52.8 59.2m195.4 0c-29 0-52.8-26.6-52.8-59.2s23.4-59.2 52.8-59.2c29.7 0 53.3 26.8 52.8 59.2 0 32.7-23.2 59.2-52.8 59.2"/></svg> </a> </div> </div> </div> </footer> <div class="md-footer-meta md-typeset" style=margin-top:.5rem> <div class=md-footer-meta__inner> <div class=md-footer-meta__item> <small>*Last updated: <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date" title="September 1, 2025 23:10:06 EEST">2025-09-01</span>*</small> </div> </div> </div> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../../..", "features": ["navigation.instant", "navigation.top", "navigation.footer", "toc.integrate", "content.code.copy", "content.code.annotate", "content.tabs.link", "content.action.edit", "content.action.view", "search.suggest", "search.highlight", "header.autohide"], "search": "../../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script> <script src=../../../assets/javascripts/bundle.92b07e13.min.js></script> <script src=../../../assets/js/persist-nav.js></script> </body> </html>